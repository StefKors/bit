# Nixpacks configuration for Coolify deployment
# TanStack Start + Bun application

[phases.setup]
nixPkgs = ["bun", "nodejs_20"]

[phases.install]
cmds = ["bun install --frozen-lockfile"]

[phases.build]
cmds = ["bun run build", "bun run db:migrate", "bunx zero-deploy-permissions --schema-path src/db/schema.ts"]

[start]
cmd = "bun run server.ts"

[variables]
NODE_ENV = "production"

