---
globs: src/components/**/*.tsx,src/features/**/*.tsx,src/pages/**/*.tsx
alwaysApply: false
---

# Component Rules

## File Structure

- **Components**: `src/components/` (shared) or `src/features/` (feature-specific)
- **Pages**: `src/pages/` for page-level components
- **CSS Modules**: Same name as component, e.g., `Button.tsx` + `Button.module.css`

## Naming Conventions

- **Files**: kebab-case (`pr-list-item.tsx`) or PascalCase (`PRListItem.tsx`)
- **Components**: PascalCase (`PRListItem`)
- **CSS Modules**: PascalCase matching component (`PRListItem.module.css`)

## Arrow Functions

Prefer arrow functions for components:

```tsx
// ✅ GOOD
const PRListItem = ({ pr }: { pr: GithubPullRequest }) => {
  return <div>{pr.title}</div>
}

// Also acceptable for exports
export const PRListItem = ({ pr }) => <div>{pr.title}</div>
```

## One Component Per File (Usually)

Keep one main component per file. Colocate small helper components:

```tsx
// PRListItem.tsx

// Small helper - colocate here
const StatusBadge = ({ state }: { state: string }) => (
  <span className={styles.badge}>{state}</span>
)

// Main component - one per file
export const PRListItem = ({ pr }) => (
  <div>
    <StatusBadge state={pr.state} />
    {pr.title}
  </div>
)
```

## Extract Components When Mapping

When mapping data, create separate components:

```tsx
// ❌ BAD - Inline mapping
{repos.map(repo => (
  <div key={repo.id}>
    <h3>{repo.name}</h3>
    <p>{repo.description}</p>
    {/* 50 more lines... */}
  </div>
))}

// ✅ GOOD - Extracted component
{repos.map(repo => (
  <RepoCard key={repo.id} repo={repo} />
))}
```

## Minimize Props

Avoid passing many props. Consider:

1. **Context** for deeply nested data
2. **Composition** over configuration
3. **Query hooks** to fetch data where needed

```tsx
// ❌ BAD - Prop drilling
<PRDetail
  pr={pr}
  repo={repo}
  files={files}
  reviews={reviews}
  comments={comments}
  onApprove={handleApprove}
  onRequestChanges={handleRequestChanges}
/>

// ✅ GOOD - Component fetches its own data
<PRDetail prNumber={prNumber} repoFullName={repoFullName} />
```

## CSS Modules

Use CSS modules for styling. Import CSS variables from `theme.css`:

```tsx
import styles from "./Button.module.css"

const Button = ({ children }) => (
  <button className={styles.button}>{children}</button>
)
```

```css
/* Button.module.css */
.button {
  background: var(--color-accent);
  padding: var(--spacing-sm) var(--spacing-md);
}
```

## Uncontrolled Inputs

For uncontrolled components, use refs instead of state:

```tsx
// ✅ GOOD - Ref for uncontrolled input
const inputRef = useRef<HTMLInputElement>(undefined)

const handleSubmit = () => {
  const value = inputRef.current?.value
  // Use value directly
}

return <input ref={inputRef} defaultValue="initial" />

// ❌ BAD - State + effect for uncontrolled input
const [value, setValue] = useState("initial")
useEffect(() => {
  inputRef.current.value = value  // Anti-pattern
}, [value])
```
